let example = `#.##..##.
..#.##.#.
##......#
##......#
..#.##.#.
..##..##.
#.#.##.#.

#...##..#
#....#..#
..##..###
#####.##.
#####.##.
..##..###
#....#..#`;

let my_input = `.##.###..####..
....#..#.####.#
.##.###...##...
.##..###..##..#
.##..##..#..#..
####.#####..###
####.##..####..
#..###..#.##.#.
#..#....##..##.
...#.#.###..###
......#.#.##.#.
.....##...##...
#####...##..##.

....#.#..#.
####.##.###
##.##..####
..#.#.#....
#...#.###.#
..#.###.###
..#.###.###
....#.###.#
..#.#.#....
.#.#....##.
.#.#....##.
..#.#.#....
....#.###.#
..#.###.###
..#.###.###
#...#.###.#
..#.#.#....

......########...
....#..#.##.#..#.
##....########...
###..#.#.##.#.#..
...#....####....#
#####.########.##
..#....##..##....
###....#.##.#....
##.#.#..#..#..#.#
###.....####.....
###.#.##....##.#.
###.#####..#####.
...#...#.##.#...#
..#####......####
..#.####.##.####.
......#.#.##.#...
..#.####.##.####.

##.#.##.#.#
.###.##.###
.###.##.###
##.#.##.#.#
.##########
.##########
...##..##..
..#.####.#.
###..##..##
###..##..##
##.##..##.#
##..#.....#
..#.####.#.
..#.#..#.#.
#..#.##.#..
#.#.####.#.
##..#..#..#

#.#..#.#.
#...#####
.#..##..#
##..#.#.#
..##.###.
..##.###.
##..#.#.#
.#..##..#
##..#####
#.#..#.#.
.###.#.#.
###.#...#
..#.#.#..
...##.#..
...##.#..

.########
####.##.#
#.##..#.#
....#..#.
.#.##..##
#.###..##
...##..##
####.##.#
#....##..
###......
.#..####.
.####..##
.####..##
.#..####.
###......
#....##..
####.##.#

..##..##..#.#
..##..##..#.#
##...####...#
#.......#..##
.#..##.#.#.#.
#.##.......#.
..#.#...##...
#.#..#.##..#.
#.#..#.##..#.
..#.#...##...
#.##.......#.
.#..##.#.#.#.
#.......#..##
##...####..##
..##..##..#.#

##########.
###.##.####
..######...
.##....##..
##......###
###....####
..#.##.#..#

####.####.#######
...##.##.##......
.############.#..
###.##..##.###...
.#.#..##..#.#.#..
##...####...###..
#....#..#....##..
....#....#....###
.#..#.##.#..#..##
...###..#.#...#..
#..#......#..#.##

..##...#.##
..##...#.##
....#.##..#
#...###.###
...##.##.#.
.####....#.
.#.#...#.#.
.#.###.#.#.
.#.###.#.#.
.#.#...#.#.
.####....#.
...##.##.#.
#...###.###
....#.##..#
..#....#.##

...#####..#
.#...##...#
.##...#...#
##.#......#
..#..##.##.
..##.##.##.
##.#......#
##.#......#
..##.##.##.
..#..##.##.
##.#......#

###..#.#.
##...#.#.
......#..
##..#.###
##.###.##
..####.#.
....#.##.
....##.#.
#....#...
##..##.##
##..##.##
#....#...
....##.#.
....#.##.
..####.#.

.####..#..#..
.####........
#.##.#..##..#
#######..#.##
##..##......#
######.####.#
.####..####..

#..###..##..###
#..##..####..##
.....###..####.
######..##..###
....#........#.
#####.#....#.##
#..#.#.####.#.#

#..###...#.#..#.#
#..###...#.#..#.#
##...##.#.#.#####
#.####........#..
##..#..#..#...#..
.###.##..#####.##
....#..###..#.#.#
..###...#........
..###.#.#........
....#..###..#.#.#
.###.##..#####.##
##..#..#..#...#..
#.####........#..

#..#..#
..###.#
..####.
###.#.#
.###..#
.######
###....
###....
.###.##
.###..#
###.#.#
..####.
..###.#
#..#..#
#..#.#.
#...##.
#...##.

.....###.....
##..#..#..###
.###.##.###..
#..######..##
.##.#..#.##..
.##......##..
.###....###..
##..#..#..###
.##.#..#.##..

.....###..#..
#.#...#.#..##
#####.##.####
#..#..##.####
#...#####.###
##.###.###.##
.#.###....#..
.#.###.......
##.###.###.##

...#.#....#
..#########
###.#######
##..###..#.
..#.#######
##....####.
..#..#....#
###..##..##
....#######
##.###....#
#######..##
...###....#
##..#######
###..#.##.#
##....#..#.

..##..####..###..
######...##..##.#
######...##..#..#
..##..####..###..
######.##...####.
..##...###..#....
#.##.##.####.....
........#######..
.#..#.#...#...#..
#....##..##...###
##..##..###.##.#.
#....###.####....
.#..#.#.###.#...#

#....##..#...
.##.......#..
##.##..##..##
.#.##..##..##
.##.......#..
#....##..#...
#...###.###..

.#....#..
##.##.###
##.##.###
.#....#..
.######.#
##.##.###
........#
##.#..##.
.######.#

.......##.####.##
......#.##.##.##.
.#..#.#.#.....##.
##..#####..#.#..#
#.##.#.#.##.#....
..##...###.#.#..#
......#..#.......
.####....##......
.......##.##.####
.#..#.##.###..##.
########..###.##.

.....####....
#####....####
##..##..##..#
#.##......##.
#.##########.
..##..##..##.
#.##..##..##.
.####.##.####
##..#.##.#..#

#...#.####.
..##.###..#
#.#.##.....
########..#
..#..###..#
#....##....
##..#..#..#
#..####....
#..####....
##..#..#..#
#....##....
..#..###..#
########..#

##..#......#.#..#
#...#......#.#..#
..#.#.#.##..#....
###.###.##...####
#..##.#...#.#.##.
#.####..##.#.####
...#.#...#.##.##.
#.####.###..##..#
##..#..##.....##.
####.....##.##..#
.#.....##.###....

###..#######.
.##..##.###.#
##.##.##.#.#.
##.##.##.#.#.
.##..##.###.#
###..#######.
#......#..#.#
..####.##...#
#.####.####..
.#.##.#.##...
#.#..#.#...##
#......#####.
##########.#.

.#..#.##..#
######.#..#
......###.#
#....###..#
.#..#.#.#..
.........#.
###.######.
#....#.#.##
......#.###
######.#...
#....#.##..
#....#.##..
######.#...
......#.###
#....#.#.##

....##......##.
..#..##.##.##..
###..#.####.#..
...##.#....#.##
.#...#.####.#..
#####...##...##
..#...#....#...
#######.##.####
##.#####..#####
....#...##...#.
###.#.#.##.#.#.
..#.##########.
...#..........#
..#...######...
####...#..#...#

#.#.##..#..
#.....#.###
#####.##.##
#.####.....
##..###....
#...#...#..
##...###.#.
.#.######..
.#.######..

##.#.#..#
..#.##.##
#....####
##.##.#..
.##...###
.##...##.
##.##.#..
#....####
..#.##.##
##.#.#..#
.#..##.##
.#..##.##
##.#.#..#
..#.##.##
#....####

.##.###........#.
##.#.##...#.#####
.#..#.###.#####.#
.#..#.###.#####.#
##.#.##..##.#####
.##.###........#.
##.##..#....#.###
#...#....########
.###.#..###.....#
.###.#..###.....#
#...#....########
##.##..#....#.###
.##.###........#.

#.#....#.##.###
...#..#...#.###
..........#####
##########.....
#.#.##.#.#..#..
......#...#.###
.#......#......
#..####..#.#...
....##....##.##
#.######.#..###
##.#..#.###..##
##......##.##..
.##....##.##.##

#.###.###
#.###.###
.##.#####
###.##..#
..##.#.##
.###.#.##
..#.#.#.#
.#.#...#.
#..###.#.
#..###.#.
.#.#...#.
..#.#.#.#
.###.#.##
..##.#.##
###.##..#
.##.#####
#####.###

......#.#..###.
###..####....#.
####..###.###..
###.######.....
#######.#.##...
#######.#.##...
###.######.....
####..###.###..
###..####....#.
......#.#..###.
#####...#####.#
.#.###.#..#.###
###..###...#...
..##....##.....
###.##..##.#.#.
####...##.#.#.#
####..#.#.###..

...##......
..#....##..
###..######
#.#.##....#
..###.#..#.
....#.####.
######.##.#

#..##....###.
#..##....###.
#....#.###...
.####.##.#.##
.####..#...##
####.#...#...
.###...#.#...
.###...#.#.#.
####.#...#...
.####..#...##
.####.##.#.##

..##..#.##...#.##
....##....#..#...
....##....#..#...
.###..#.##...#.##
####.....#.....##
#.##...##.##.##..
.###.....####.###
#.#...###.##.##..
#.....###.#####..
##.##.#..#.#...##
.#####.##..#...##
.####.#.#....####
.#.#.##.#.####...
..#..##...#.#####
.####...##..##...

##..#.#
##..#.#
...###.
##.#.##
.#..###
..#..##
......#

..##.##
##..###
.###..#
####.##
#.##.##
#.#...#
#.#####
###....
#......
.#.###.
.#.###.
#......
###....
#.#####
#.#...#
#.##.##
####.##

#.####.#..###.##.
.#....#.#.#.##..#
##....##.##.##..#
.#....#.#.##..##.
###########..#..#
.#....#..#..#####
..#..#....###.##.
.#.##.#..#...#..#
#..##..##.##.####
##....#####.#####
.###.##....##....

.####...##....#
#.##.##.##....#
########..####.
######.#..####.
.####...#......
..##..#........
#########......
.####..###....#
#....#####...##
#....#.#.##..##
..##....#.####.
..##...########
######...##..##
.####.#.#.#..#.
.#..#...#......

.#..#.#..##
.#..#.#..##
..####.....
##.....##..
..#.#....#.
..####.###.
....#.##..#
##.#..###.#
##.#..###.#
....#.##..#
..####.###.
..#.#....##
##.....##..
..####.....
.#..#.#..##

#######..#...##
....#.#.#.###.#
##.....##......
##.....##......
....#.#.#.###.#
#######..#...##
#.##.#.###.###.
##..#.##.....#.
.#.##...####...
###.###..##..##
..##.....#.....
..##.....#.....
###.###..#...##

.#.###.######
.....#..#.#..
#..#.##......
..##.####.###
#.#...##...##
..#.###..####
##.#.#..##...
.##.#.##.#.##
..###.#.#.#..
.#.#.#.###.##
##.###..##...
##.###..##...
.#...#.###.##

###..#####.##.###
..###.#####..####
###....#.##..##.#
##.####..######..
..#.#..##.#..#.##
##..###..#....#..
###.##...######..
....#..###....###
##..##.####..####
##.#.#...#.##.#..
..#.#####..##..##
#####.....#..#...
#######.##.##.##.
.....#.##.#..#.##
###..#.#.########
..#..######..####
##.##.....####...

..#........
#..#..##..#
####..##..#
..###....##
..###....##
####..##..#
...#..##..#
..#........
#.##..##..#
...#.####.#
.#.#.#..#.#

###.#.####.
.##.#######
.####.####.
###.#......
##...#.##.#
.#.###....#
.####.#....
#....##..##
.##....##..
##.###....#
.#.#..#..#.
.##.#.#..#.
#.#..#.##.#
#.#####..##
.#.#.######
#..####..##
#..####..##

####.##.#.###
##.##.#.#####
###..#.#.#..#
##..#..#.####
...#.##.#####
...#...#.....
..#.##.#.....
..###.#.##..#
##.#######..#

.#.#.######
.#....##..#
.##..#.#..#
.#####..##.
###.#..####
...##.#....
.#..##.....
.#..##.....
...##.#....
###.#..####
.######.##.
.##..#.#..#
.#....##..#

####..##..#
.##........
.##..####..
####.....##
#####.##.##
.....#..#..
....#....#.

..#..#.
....#.#
##.##.#
##...##
...#...
##..##.
##.###.

.####..#.#.##...#
.####.##.#..#...#
.####.#.....##..#
..##...#####...#.
#.##.#.###..##...
.####.#.#.##.###.
##..###..#...#...
.####.#....##.###
.####.#...###.###

...#..#####
.....#..#.#
#.###..#.##
#.###..#.##
.....#..#.#
...#..#####
#.#...#.##.
#.#.#.##.##
#..#.##....
.##...##..#
..#...##..#

..####.##.#
...###.##.#
.#..##.##.#
.###.##..##
...#.#....#
#.#...####.
...#.......
.#.##.#..#.
#....#.##.#
#....######
...#.......

#..##...####...##
..#...###...##...
.#.#.##..##..##.#
..#...#..##..#...
..#.#.##.##.##.#.
.###.##.####.##.#
......#..##..#...
##.#.#..####..#.#
##.#.#..####..#.#

##..###..#..#.#
.####.#.#.#..##
..##..###.#.###
#.##.#.....###.
#.##.#.....###.
..##..###.#.###
.####.#.###..##

...#.######.##.##
...#.######.##.##
#..##.....####.#.
..#######..####..
#....####.#.##.#.
..##..#.####..###
##...#.#.##.##.##
.#.#..#.....##...
##..##.##..#..#..
###.#..##.#.##.#.
####..#.##......#
.######..########
###.#.###.##..##.

..##.###..#.#..
#..#......###..
.#.########....
.#.########....
#..#......###..
..#..###..#.#..
.#.##.#.#.#....
.##.###..##..##
.#...##.###..##
.##.#.###.#....
.####..#.#..###
#..#######..###
..##..#......##

#.#..###....###
.........#.#.##
.#....###....##
#....###..#....
#....###..#....
.#....###....##
.........#.#.##
#.#..###....###
..#.#..#.##....
#.#..##..#..#.#
...#...#......#
#.#..#.#####.##
#.#..#.########

.#.#.#...#.
.#.#.#...##
.#.#.#...##
.#.#.#...#.
#.#..###.##
####.#....#
##.##.#..##
#...#####.#
#..##...#.#
#.###...#.#
.#.#....###
###..#..#.#
#.......#..
.##.#####.#
##.##....#.

######..########.
....##..###..###.
#..#..####.##.###
.....#.#.#.##.#.#
#..##...##....##.
..........####...
#..##.###..##..##
.......#..####..#
.....#....####...
#..###.#..####..#
####..#####..###.
#####..###....###
#..#.##.########.

.#..#......#.
#####.#..#.##
#####.#..#.##
.#..#......#.
###.##....##.
###..#....#..
#.#..######..
..###.####.##
#...########.
###.#......#.
#.###########
##.#.######.#
.#..##....##.
..#.##.#####.
##.#.#....#.#
##.##..##..##
###.###..###.

##.####......
..#...#.#.##.
##.#..##.#.##
##..####..##.
.....###.....
##..##.#..##.
..##....#....
##.##...#####
..###.#.#.##.

####.####
..##.####
##..#.##.
#####....
#..#.####
#..#.####
#####....
##..#.##.
.###.####

#.##.#.###.##
#.##.#.###.##
##..##..#####
.####.##.##.#
.###...###..#
.#..#..#..###
..##...##.###
#....#..###.#
.#..#.......#
..##..##..###
#....##.###.#
#....#.#.....
.####.##.###.
.####..####.#
..##..#.##...

....##########...
.##.##......##.##
...####.##.####..
####.########.###
#.#####.##.#####.
#..##.######.##..
###.#..#..#..#.##

.##.##.##.#.#...#
....##.....###..#
#.##..##.#.##..##
...#..#...#.###..
#...##...###.....
#...##...####....
...#..#...#.###..

.###.#.
####.##
####.##
.###.#.
.....##
###.###
.#..###
#.#...#
.##..##
..##.#.
..#.#.#
..#...#
..##.#.
.##..##
#.#...#

########..##.
###.#....#...
...#.###.##.#
...#.###.##.#
###.#...##...
########..##.
.....#..#..#.
....#.#..####
##....####.##
###...#...##.
##.####.#.#.#
##.###.##.##.
....#.###.##.
......###.#.#
..######..#..
...#..####..#
######.#.##..

.####.#...##.#.
..##....#####..
#.##.##..#####.
##..###.#.###.#
.####.#.#......
#.##.###..#...#
#.##.###..#...#
.####.#.#......
##..###.#.###.#
#.##.##..######
..##....#####..

##..##.#.......#.
..#.##...#.#...##
#..###..##.#.#..#
.#.#...####.##..#
##.#..#..##....#.
...#.#######..###
.#.##......##..#.
.#.##......##..##
...#.#######..###
...#.#######..###
.#.##......##..##
.#.##......##..#.
...#.#######..###

.......#.##.#
##..##.###..#
.........#..#
#.##.#..####.
#######......
#.##.####...#
#.##.#####..#

.####.##.##
.##..#####.
....#.##...
....#.##...
.##..#####.
.####.##.##
###.#####..
...#.#..#..
.#....###..
.##...#.###
##......###
##......###
.##...#..##

###.#.#.#
#.##.##.#
#.##.##.#
###.#...#
....#.#.#
..##..#..
.#####.#.
#.#.#...#
...######
..#..###.
##...##..
#.###.###
.##.###.#
###...##.
###...##.

#.#######
#..######
#..#....#
.#.##..##
..###..##
...#....#
##.#####.
####....#
####....#
##.#####.
...#....#
..###..##
.#.##..##
#..#....#
#..######
#.#######
.#.......

.###.##...#######
###..#.#####.#..#
.####.#.##.##.#.#
.##.....##.##.#.#
...######.##.#.##
...######.##.#.##
.##.....##.##.#.#
.####.#.##.##.#.#
###..#.#####.#..#
.###.##...##.####
##.###...##..##..
##.###...##..##..
.###.##...##.####
###..#.#####.#..#
.####.#.##.##.#.#

..####..#
...#..###
#..####..
#.#.#.##.
#####..##
..##.#.#.
..##.#.#.
#####..##
#.#.#.##.
#..####..
...#..###
..####..#
####.####
.###.####
..####..#
...#..###
#..####..

.##..#.
#..#..#
....###
#..#.#.
#..#.#.
....###
#..#..#
.##..#.
#...#..
####..#
.##..#.
.....#.
#..##.#

#.##..##.
#...##...
...####..
.########
#..#..#..
#..#..#..
#...##...
.##.##.##
.###..###
#...##...
.###..###

##.##........##.#
########..#######
...##.######.##..
..#.#.##..##.#.#.
....###.##.###...
##.#..######..#.#
##...#.####.....#
..###........###.
#####...##...####
..#####....#####.
....####..####...
..#..#.#..#.#..#.
#####...##...####

...#.######.#..
..##........##.
##.##########.#
###.##.##.##.##
##.#..####..#.#
..#####..#####.
####.######.###
##.#..#..#..#.#
####..#..#..###
..##...###..##.
##...#.##.#...#

..##....##.
##.##..##.#
..########.
..#.##.#.#.
..##....##.
..#.####.#.
##.######.#

#..#..##....###
....#.#..##..#.
....##.#######.
....##.#######.
....#.#..##..#.
#..#..##....###
#..##...##.##.#
#####.#...#....
.......#...#.##
.......######..
.##.##.#.###...
.##.##.###.#.##
..#...###..#...

...#..#.###.#..
##.#####....###
.....##..##.##.
###.##..##.....
###.#.##..#.###
###..##.#..##.#
...#.##.##..##.
.....#...#.###.
..#...####.###.
..##.###...####
..###...#######
###.#.##.#..#..
........#..##..
....#..#.##...#
....#....##...#

#.##.#..#.#
#.##.#..#.#
###..####..
.##.#..#.#.
...##.##.##
###.##..##.
#....####..

##.#.#.##.#..
...##....####
.##..##.#####
#.##.##...###
#....##..##.#
..##..#.##..#
..##..#.##..#
#....##..##.#
#.##.##...###
.##..##.#####
...##....####
##.#...##.#..
##.#...##.#..

........#..#...
#######.#.#####
.####.#.####...
.####.#...###..
#.##.#....#..#.
.#..#......##..
.......##..###.
##..##....#####
######.#..#####
######.#..#####
##..##...######

#..#....##...
..##.##.##.##
###..##.##.##
##...##.##.##
###.....##...
.....##.##.##
..###.#....#.
#......####..
#.##.........
..######..###
##..####..###
..#.#........
#.##...#..#..

##.#.#...
#.#......
#....####
#....###.
#.#......
##.#.#...
..#.#.#.#
..#.#.#.#
##.#.#...
#.#......
#....###.

.##..##..###.##
.###.##..###.##
###.#....#..#..
..#....#.##..#.
##...#..#....#.
..####.##.#.#..
..####.##.#.#..

.##...###
#..#.#..#
...#.#..#
##.##....
######..#
######..#
##.##....

########...####..
...##....########
...##....#......#
###...##.##....##
..####..#.#....#.
#.####.#.##....##
###..###.#.#..#.#
###..###.########
.######..###..###

###.#..
.#...##
####...
##.#.##
####.##
####.##
..###..
..#..##
###.###
..#....
###....
##.#.##
##..#..
..#####
###..##

#..#..#####
#..#..#####
#####.##.#.
###.....#.#
###.###...#
..#.#..##.#
..#.#..##.#
###.###...#
###....##.#

#..#.#.#.#.##
####.#..#####
...#....#.#.#
#..##.###....
.....###..##.
####..#....##
#..##..#.#..#
#..##..#.#..#
####..#....##

.#.#...#.#..#.#
##.####...##...
#.###.#........
.#.##...######.
.#.##...######.
#.##..#........
##.####...##...
.#.#...#.#..#.#
.#..##..######.

####..###
.###.####
...###.##
.......##
..#.#.###
###.##.##
#..#.##..
###..####
###..####
...#.##..
###.##.##
..#.#.###
.......##

####.##..####
######.####..
#####.###.###
#..#..#.#..#.
#..#..#.#..#.
#####.###.###
######.####..
####.##..####
....#......##
.##..#..#.#..
.##.##..#....
##.#..#.##...
#..##.##...#.
......#..###.
.....#..##.##

#.##..###....
....#########
##.###.......
...##..##....
...#.#.##....
.#.##..#.....
...#####.####
######..#####
....#.#######
#.#######....
.###...#.#..#`;


function count_differences(str1: string, str2: string): number {
    let differences = 0;

    for (let i = 0; i < str1.length; i++) {
        if (str1[i] !== str2[i]) {
            differences++;
        }
    }

    return differences;
}


function reflects_between(lines: any, i: number, smudge: number) {
    let j = i +1;
    while(i >= 0 && j < lines.length){
        smudge -= count_differences(lines[i], lines[j])
        if(smudge < 0){
            return false;
        }
        i--;
        j++;
    }
    return smudge == 0;
}

function  find_refelction(lines: string[], smudge) {
    for(let i = 0; i < lines.length-1; i++){
        if(reflects_between(lines, i, smudge)){
            return i+1;
        }
    }
    return null;
}


function compute_columns(input) {
    const lines = input.split('\n');
    const maxLength = Math.max(...lines.map(line => line.length));
    const columns: string[] = Array.from({ length: maxLength }, () => '');

    lines.forEach(line => {
        Array.from(line).forEach((char, index) => {
            columns[index] += char;
        });

        // If the line is shorter than the longest line, fill in the rest of the columns with spaces
        if (line.length < maxLength) {
            for (let i = line.length; i < maxLength; i++) {
                columns[i] += ' ';
            }
        }
    });

    return columns;
}

function find_reflexion(input, smudge){
    let res = 0;
    input.split("\n\n").forEach(
        puzzle => {
            let row = find_refelction(puzzle.split("\n"), smudge);
            if(row != null){
                res += 100 * row
            }else{
                let cols = compute_columns(puzzle);
                res += find_refelction(cols, smudge);
            }
        }
    )
    return res;
}

function part1(input){
    return find_reflexion(input, 0)
}

function part2(input){
    return find_reflexion(input, 1)
}

console.log("Part1 example : " + part1(example))
console.log("Part 1 my input : " + part1(my_input))

console.log("Part 2 example : " + part2(example))
console.log("Part 2 my input : " + part2(my_input))
